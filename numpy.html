<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>NumPy basics - Physical Chemistry: A numerical approach</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li><a href="motivation.html"><strong aria-hidden="true">1.</strong> Motivation</a></li><li><a href="programming.html"><strong aria-hidden="true">2.</strong> Python programming basics</a></li><li><a href="numpy.html" class="active"><strong aria-hidden="true">3.</strong> NumPy basics</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Physical Chemistry: A numerical approach</h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#numpy-basics" id="numpy-basics">NumPy basics</a></h1>
<p><a href="https://numpy.org/">NumPy</a> is a Python module, developed to simplify
scientific computations. It is part of <a href="https://www.scipy.org">SciPy stack</a>, which provides
wide variety of routines for linear algebra, Fourier tranformation,
optimization, statistics, etc. It brings the power of mathematical software
like MATLAB and beyond, combines it with flexibility and convinience of Python 
and is available under open-source license. These factors make SciPy a perfect
choice for both educational and academic computations.</p>
<h2><a class="header" href="#module" id="module">Module</a></h2>
<p>Python allows code structuring by packaging the files into modules.
Modules need to be installed prior to use. The most convinient way to
do it is to use PIP, the Python package manager:</p>
<pre><code>pip install &lt;package_name&gt;
</code></pre>
<p>E.g. to install NumPy</p>
<pre><code>pip install numpy
</code></pre>
<p>In case Spyder is used, NumPy, SciPy should be already installed.</p>
<h2><a class="header" href="#numpy-array" id="numpy-array">NumPy array</a></h2>
<p>The data structure, which is in the heart of the whole SciPy ecosystem.
It is an array of the data of same type. To create such array:</p>
<pre><code class="language-python">import numpy as np # load the NumPy module and give it alias np
arr = np.array([0, 1, 2, 3, 4])
print(arr)
</code></pre>
<pre><code>[0 1 2 3 4]
</code></pre>
<p>Despite array looks same as Python list, it provides lots of useful methods.
To see them, in IPython console type the name of array, add dot and press tab.
The pop-up with the list of methods should occur:</p>
<p><img src="./img/numpy_methods.png" alt="alt text" /></p>
<p>Full list of methods is available in the <a href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html">official documentation</a></p>
<p>A few examples:</p>
<pre><code>In [65]: arr.mean()
Out[65]: 2.0

In [66]: arr.sum()
Out[66]: 10

In [67]: arr.var()
Out[67]: 2.0

In [68]: arr.prod()
Out[68]: 0
</code></pre>
<p>One of the most widely used features is paralell computation, i.e.
application of function to the array will lead to application of it
to every element of an array. In the previous chapter it was shown how 
to calculate squares of the array:</p>
<pre><code class="language-python">for elem in lst1:
    print(elem**2)
</code></pre>
<p>The same problem in NumPy could be solved in a very elegant way:</p>
<pre><code>In [71]: np.power(arr, 2)
Out[71]: array([ 0,  1,  4,  9, 16])
</code></pre>
<p>(Here np.power is a function, which raises the input to the given power)
Or even simplier:</p>
<pre><code>In [72]: arr**2
Out[72]: array([ 0,  1,  4,  9, 16])
</code></pre>
<p>This is a typical way to plot a function in Python:</p>
<pre><code class="language-python">import numpy as np # load the NumPy module and give it alias np
import matplotlib.pyplot as plt # load pyplot submodule and give it alias plt

x = np.linspace(-5, 5, 1000) # create array of 1000 points, equally spaced in the range [-5, 5]
y = np.power(x, 3) # apply the function to the array to get y values

plt.plot(x, y) # plot x, y pairs
plt.show() # show the plot
</code></pre>
<p>This code will produce following image:
<img src="./img/cubic_plot.png" alt="" /></p>
<p>NumPy arrays are not limited to 1D case. They could have arbitrary dimensionality,
such as matrices:</p>
<pre><code class="language-python">A = np.array([[1, 0, 0],
              [0, 1, 0],
              [0, 0, 2]])
</code></pre>
<p>The size of matrix could be obtained with <em>shape</em> method:</p>
<pre><code>In [9]: A.shape
Out[9]: (3, 3)
</code></pre>
<p>The linear algebra routines could be used for matrix multiplication:</p>
<pre><code class="language-python">A = np.array([[1, 0, 0],
              [0, 1, 0],
              [0, 0, 2]])

b = np.array([1, 1, 1])
print(np.dot(A, b)) # dot product A*b
</code></pre>
<pre><code>[1 1 2]
</code></pre>
<p>inversion:</p>
<pre><code class="language-python">In [24]: np.linalg.inv(A)
Out[24]: 
array([[1. , 0. , 0. ],
       [0. , 1. , 0. ],
       [0. , 0. , 0.5]])
</code></pre>
<p>Or to solve system of linear equations:</p>
<pre><code class="language-python">res = np.linalg.solve(A, b) # solve system of linear equations A*x = b
print(&quot;Solution:&quot;, res) # x
print(&quot;Verification:&quot;, A@res) # @ is a dot product operator
</code></pre>
<pre><code>Solution: [1.  1.  0.5]
Verification: [1. 1. 1.]
</code></pre>
<p>NumPy array has unusually powerful indexing system:</p>
<pre><code class="language-python">A = np.array([[1, 2, 3],
              [4, 5, 6],
              [7, 8, 9]])
</code></pre>
<pre><code>In[5]: A[0,1] # first row, second column
Out[5]: 2

In [6]: A[:,1] # all rows, second column
Out[6]: array([2, 5, 8])

In [7]: A[2,:] # third row, all columns
Out[7]: array([7, 8, 9])

In [8]: A[0:2,0:2] # rows from first to third, columns from first to third
Out[8]: 
array([[1, 2],
       [4, 5]])

In [11]: mask = [True, False, True] # create boolean mask

In [12]: A[mask,:] # take rows according to mask, all columns
Out[12]: 
array([[1, 2, 3],
       [7, 8, 9]])
</code></pre>
<p>Overall, it is difficult to say which functionality is important for chemist
and which does not. In any case, reading documentation might be a good idea.
Also, Python has a developed community, and almost any question can
be answered by simple searching for it in the web.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="programming.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="programming.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
            </nav>

        </div>

        
        <!-- Livereload script (if served using the cli tool) -->
        <script type="text/javascript">
            var socket = new WebSocket("ws://localhost:3001");
            socket.onmessage = function (event) {
                if (event.data === "reload") {
                    socket.close();
                    location.reload(true); // force reload from server (not from cache)
                }
            };

            window.onbeforeunload = function() {
                socket.close();
            }
        </script>
        

        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
